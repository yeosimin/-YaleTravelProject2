<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>상품 목록</title>
    <style>
        ul {
            list-style-type: none; /* 점 제거 */
            padding: 0; /* 기본 패딩 제거 */
        }
        li {
            margin-bottom: 20px; /* 항목 간 간격 조정 */
        }
    </style>
    <script>
        function parseDate(dateString) {
            var parts = dateString.split(/[- :]/);
            return new Date(parts[0], parts[1] - 1, parts[2], parts[3], parts[4], parts[5]);
        }

        function sortProducts() {
            var sortBy = document.getElementById("sortBy").value;
            var ul = document.querySelector("ul");
            var products = Array.from(ul.children);

            products.sort(function(a, b) {
                if (sortBy === "latest") {
                    return parseDate(b.querySelector(".productUpdatedAt").innerText) - parseDate(a.querySelector(".productUpdatedAt").innerText);
                } else if (sortBy === "oldest") {
                    return parseDate(a.querySelector(".productUpdatedAt").innerText) - parseDate(b.querySelector(".productUpdatedAt").innerText);
                } else if (sortBy === "popular") {
                    return parseInt(b.querySelector(".productViews").innerText) - parseInt(a.querySelector(".productViews").innerText);
                }
            });

            ul.innerHTML = "";
            products.forEach(function(product) {
                ul.appendChild(product);
            });
        }

        document.addEventListener("DOMContentLoaded", function() {
            document.getElementById("sortBy").addEventListener("change", sortProducts);
            sortProducts(); // 페이지 로드 시 기본 정렬
        });
    </script>
</head>
<body>
<h1>상품 목록</h1>

<!-- 정렬 드롭다운 메뉴 -->
<label for="sortBy">정렬 기준:</label>
<select id="sortBy">
    <option value="latest">최신순</option>
    <option value="oldest">오래된순</option>
    <option value="popular">인기순</option>
</select>

<ul>
    <li th:each="product : ${products}" th:if="${!product.productFlag}">
        <a th:href="@{/store/{id}(id=${product.productId})}">
            <img th:src="${product.productImageUrl}" alt="상품 이미지" style="max-width: 200px;" />
            <h2 th:text="${product.productName}"></h2>
        </a>
        <p th:text="${product.productDescription}"></p>
        <p th:text="${product.productIsInternational ? '해외' : '국내'}"></p>
        <p>판매 중</p>
        <p>
            <span th:switch="${product.productPlaceOfDeparture}">
                <span th:case="1">인천국제공항</span>
                <span th:case="2">김포국제공항</span>
                <span th:case="3">제주국제공항</span>
                <span th:case="4">부산 김해국제공항</span>
                <span th:case="5">대구국제공항</span>
                <span th:case="6">청주국제공항</span>
                <span th:case="7">무안국제공항</span>
                <span th:case="8">양양국제공항</span>
                <span th:case="*">알 수 없음</span>
            </span>
        </p>
        <p>조회수: <span class="productViews" th:text="${product.productViews}"></span></p>
        <p>수정 날짜: <span class="productUpdatedAt" th:text="${#temporals.format(product.productUpdatedAt, 'yyyy-MM-dd HH:mm:ss')}"></span></p>
    </li>
</ul>
</body>
</html>
